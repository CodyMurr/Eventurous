<%- include('../partials/header') %>

<section id="show-post" class="flex col">
    <h2><%= post.title %></h2>
    <p><%= post.event %> </p>
    <div class="flex row">
        <h3><%= post.venue %>&nbsp;|&nbsp;</h3>
        <h3><%= post.location %></h3>
    </div>
</section>

<h2>Comments</h2>
<% if (user) { %>
<form id="add-comment-form" class="flex col" method="POST" action="/posts/<%= post._id %>/comments">
    <label>Comment: </label>
    <textarea name="content" cols="60" rows="5" required></textarea>
    <button type="submit">Post</button>
</form>
<% } %>

<% if (post.comments.length) { %> 
    <% post.comments.forEach(function(c) { %>
        <section id="comment" class="flex row">
            <div id="user" class="flex col">
                <img src="<%= c.userAvatar %>" alt="avatar">
                <h5><%= c.userName %></h5>
            </div>
            <div id="content" class="flex row">
                <p><%= c.content %></p>    
            <% if (user && user._id.equals(c.user)) { %>
                <form action="/comments/<%= c._id %>?_method=DELETE" method="POST">
                    &nbsp;&nbsp;<button type="submit"><i class="far fa-trash-alt"></i></button>
                </form>
            <% } %>
            </div>
        </section>
    <% }); %>
    <% } else { %>
        <h3>No Comments Yet</h3>
    <% } %>

<%- include('../partials/footer') %>